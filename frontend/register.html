
<html>

<head>
  <title>UniSupport Registration Page</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <style>
    body {
            background-color: #f2f2f2;
            font-family: Arial, sans-serif;
        }

    .register-card {
            width: 350px;
            margin: 50px auto;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        button {
            background: #007bff;
            color: white;
            border: none;
        }

        button:hover {
            background: #0056b3;
        }
    .required::after { content: " *"; color: #d63384; }
  </style>
</head>
<body>

<main class="container d-flex justify-content-center align-items-center vh-100">

  <div class="card shadow p-4 w-100" style="max-width: 450px;">
        <h2 class="text-center mb-4">Create Account</h2>
      <div class="mb-3 text-end">
            <small class="text-muted">Already have an account? <a href="#">Sign in</a></small>
        </div>
      <form id="registerForm">
       <div class="mb-3">
                <label for="firstname" class="required">First Name</label>
                        <input type="text" class="form-control" id="firstname" required>
          <div class="invalid-feedback">First Name is required.</div>
        </div>

        
        <div class="mb-3">
                <label for="lastname" class="required">Last Name</label>
                        <input type="text" class="form-control" id="lastname" required>
          <div class="invalid-feedback">Last Name is required.</div>
        </div>

        
        <div class="mb-3">
                <label for="email" class="required">Email</label>
                        <input type="text" class="form-control" id="email" required>
          <div class="invalid-feedback">Enter a valid email address.</div>
        </div>

       
        <div class="mb-3">
                <label for="phonenumber" class="form-label">Phone Number</label>
                <input type="tel" class="form-control" id="phonenumber">
            </div>

      
         <div class="mb-3">
                <label for="password" class="form-label required">Password</label>
                <div class="input-group">
                    <input type="password" class="form-control" id="password" required> 
                </div>
                <div class="form-text">At least 8 characters. Use letters & numbers.</div>
                <div class="invalid-feedback">Password is required and must be at least 8 characters.</div>
            </div>

        
        <div class="mb-3">
                <label for="confirmpassword" class="form-label required">Confirm Password</label>
                <input type="password" class="form-control" id="confirmpassword" required>
                <div class="invalid-feedback" id="confirmPasswordError">Passwords do not match.</div>
            </div>

        <button type="submit" class="btn btn-primary w-100">Create Account</button>
        <div class="alert mt-3 d-none" role="alert" id="statusMessage"></div>
      </form>

      <div class="text-end mt-3">
            <small>&copy; copy</small>
        </div>
  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
    
    const register = (userData) => {
        return new Promise((resolve, reject) => {
            console.log("Mock API Call for Registration:", userData);
            
            
            setTimeout(() => {
                
                if (userData.email.toLowerCase() === "fail@test.com") {
                    reject(new Error("Email already exists: fail@test.com"));
                } 
                
                else if (userData.password === "error1234") {
                    reject(new Error("Database connection failed."));
                }
                
                else {
                    resolve({ id: Math.floor(Math.random() * 1000), message: "User successfully registered" });
                }
            }, 1500); 
        });
    };
    

    const registerForm = document.getElementById('registerForm');
    const statusMessage = document.getElementById('statusMessage');

   
    const showAlert = (message, type) => {
        statusMessage.textContent = message;
        statusMessage.className = `alert mt-3 alert-${type}`;
        statusMessage.classList.remove('d-none');
    };

    
    const hideAlert = () => {
        statusMessage.classList.add('d-none');
    };

   
    registerForm.addEventListener('submit', async (event) => {
        
        event.preventDefault(); 
        hideAlert();            
        
        
        registerForm.classList.remove('was-validated');
        const allInputs = registerForm.querySelectorAll('input');
        allInputs.forEach(input => input.classList.remove('is-invalid'));

       
        const firstname = document.getElementById('firstname').value.trim();
        const lastname = document.getElementById('lastname').value.trim();
        const email = document.getElementById('email');
        const phonenumber = document.getElementById('phonenumber').value.trim();
        const passwordInput = document.getElementById('password');
        const confirmInput = document.getElementById('confirmpassword');
        const password = passwordInput.value;
        const confirmPassword = confirmInput.value;
        
        let isValid = true;

        
        
        
        if (!registerForm.checkValidity()) {
            isValid = false;
        }

        
        if (password.length < 8) {
            passwordInput.classList.add('is-invalid');
            isValid = false;
        } 
        
        
        if (password !== confirmPassword) {
            confirmInput.classList.add('is-invalid');
            isValid = false;
        }

        
        if (!isValid) {
            registerForm.classList.add('was-validated');
            showAlert('Please check the required fields and fix the errors.', 'danger');
            return;
        }
        
        
        try {
            const userData = {
                firstname: firstname,
                lastname: lastname,
                email: email.value, 
                password: password,
                phonenumber: phonenumber, 
                role: 'student'     
            };

            
            const submitButton = registerForm.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.textContent = 'Creating Account...';
            
            
            const data = await register(userData);

            
            console.log("Registration API Response:", data);
            showAlert('Registration successful! Redirecting to sign in...', 'success');
            
            
            setTimeout(() => {
                window.location.href = 'index.html'; 
            }, 2000);

        } catch (error) {
            
            console.error("Registration failed:", error);

            
            const submitButton = registerForm.querySelector('button[type="submit"]');
            submitButton.disabled = false;
            submitButton.textContent = 'Create Account';

            
            const errorMessage = error.message || "An unexpected error occurred during registration. Please try again.";
            
            
            if (errorMessage.includes('Email already exists')) {
                email.classList.add('is-invalid');
                email.nextElementSibling.textContent = 'An account with this email already exists.';
                showAlert('Registration Failed: An account with this email already exists.', 'warning');
            } else {
                showAlert(`Registration Failed: ${errorMessage}`, 'danger');
            }
        }
    });
</script>
</body>
</html>


